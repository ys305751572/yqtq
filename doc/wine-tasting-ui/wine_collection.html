<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no" />
<title>美酒收藏</title>
<link rel="stylesheet" type="text/css" href="css/common.css"/>
<link rel="stylesheet" type="text/css" href="css/style.css"/>
<script src="js/jquery-2.1.4.min.js" type="text/javascript"></script>
<script type="text/javascript" src="js/hammer.min.js"></script>
<script type="text/javascript" src="js/zepto.min.js"></script>
</head>

<body style="overflow:hidden">
<!-----美酒收藏按钮部分 start----------------->
<section class="sec_wbtn flex_box clear_padding vertical">
  <!---checkbox start---->
  <div class="icon_box icon_invoice1">
    <i class="iconfont check">&#xe614;</i>
    <i class="iconfont checked" style="display:none;">
    &#xe614;
    </i>
  </div> 
  <!---checkbox end------>
  <div class="flex">全选</div>
  <!---加入购物车 start---------------->
  <a class="a_wine a_orange" href="javascript:void(0)" target="_blank">加入购物车</a>
  <!---加入购物车 end------------------>
  <!---删除选中 start----------->
  <a class="a_wine a_red a_delete" href="javascript:void(0)" target="_blank">删除选中</a>
  <!---删除选中 end------------->
</section>
<!-----美酒收藏按钮部分 end------------------->
 <div class="box"> 
  <section class="sec_car flex_box">
    <!--left start---------->
    <div class="left_car flex_box clear_padding">
       <!---checkbox start-----> 
       <div class="icon_box icon_invoice flex_box vertical">
          <i class="iconfont check">&#xe614;</i>
          <i class="iconfont checked" style="display:none;">
           &#xe614;
          </i>
      </div> 
      <!---checkbox end-------> 
      <div class="cho_tu tu_car"><img src="img/cho_tu.jpg" /></div>
      <div class="flex car_wz">
        <span class="sp_cart sp_coll">法国圣杯生干红葡萄酒750ml（6瓶装）</span>
        <!--价格 start---------------->
        <div class="flex_box vertical car_wz">
          <div class="flex red">¥120.00元</div>
          <!---购物车图标 start--------->
          <i class="iconfont i_car">&#xe605;</i>
          <!---购物车图标 end-----------> 
        </div>
        <!--价格 end------------------>
      </div>
    </div>
    <!--left end------------>
    <!--right start------------------>
    <div class="right_car flex_box vertical horizontal">删除</div>
    <!--right end-------------------->
  </section>
 <section class="sec_car flex_box">
    <!--left start---------->
    <div class="left_car flex_box clear_padding">
      <!---checkbox start-----> 
       <div class="icon_box icon_invoice flex_box vertical">
          <i class="iconfont check">&#xe614;</i>
          <i class="iconfont checked" style="display:none;">
           &#xe614;
          </i>
      </div> 
      <!---checkbox end------->  
      <div class="cho_tu tu_car"><img src="img/cho_tu.jpg" /></div>
      <div class="flex car_wz">
        <span class="sp_cart sp_coll">法国圣杯生干红葡萄酒750ml（6瓶装）</span>
        <!--价格 start---------------->
        <div class="flex_box vertical car_wz">
          <div class="flex red">¥120.00元</div>
          <!---购物车图标 start--------->
          <i class="iconfont i_car">&#xe605;</i>
          <!---购物车图标 end-----------> 
        </div>
        <!--价格 end------------------>
      </div>
    </div>
    <!--left end------------>
    <!--right start------------------>
    <div class="right_car flex_box vertical horizontal">删除</div>
    <!--right end-------------------->
  </section>
  <section class="sec_car flex_box">
    <!--left start---------->
    <div class="left_car flex_box clear_padding">
      <!---checkbox start-----> 
       <div class="icon_box icon_invoice flex_box vertical">
          <i class="iconfont check">&#xe614;</i>
          <i class="iconfont checked" style="display:none;">
           &#xe614;
          </i>
      </div> 
      <!---checkbox end------->  
      <div class="cho_tu tu_car"><img src="img/cho_tu.jpg" /></div>
      <div class="flex car_wz">
        <span class="sp_cart sp_coll">法国圣杯生干红葡萄酒750ml（6瓶装）</span>
        <!--价格 start---------------->
        <div class="flex_box vertical car_wz">
          <div class="flex red">¥120.00元</div>
          <!---购物车图标 start--------->
          <i class="iconfont i_car">&#xe605;</i>
          <!---购物车图标 end-----------> 
        </div>
        <!--价格 end------------------>
      </div>
    </div>
    <!--left end------------>
    <!--right start------------------>
    <div class="right_car flex_box vertical horizontal">删除</div>
    <!--right end-------------------->
  </section>
</div>  
</body>
<script type="text/javascript">
 $(function(){
	 //滑动
	var hammertime = new Hammer.Manager($('.box').get(0));
	hammertime.add(new Hammer.Swipe());
	hammertime.on("swipeleft",function(e) {
	    $(e.target).closest('section').animate({
			marginLeft:'-20%'
	    }).siblings().animate({
			marginLeft:'0'
			}),hammertime.on("swiperight",function(){
			 $(e.target).closest('section').animate({
			 marginLeft:'0'
	    })
		});
	 });
	 //选项选中
        $('.icon_invoice').on('tap', function () {
            $(this).find('.checked').toggle();
            $(this).find('.check').toggle();
			//判断选中的数量
			var curCount = 0;//默认正勾选的是索引值为0的列
			var count = $('.icon_invoice').length;			
			$('.icon_invoice').find('i.checked').each(function(){
				if($(this).css('display') != 'none'){
					curCount += 1;
				}
			});
			if(count == curCount){
				$('.icon_invoice1').find('.checked').show();
				$('.icon_invoice1').find('.check').hide();
			}
			else{
				$('.icon_invoice1').find('.checked').hide();
				$('.icon_invoice1').find('.check').show();
			}
        });
	//全选
	 $('.icon_invoice1').on('tap', function () {            
			//如果全选选中状态是隐藏的，说明是全部步选中
			if($(this).children('i.checked').css('display') == 'none'){
				$(this).find('.checked').show();
				$(this).find('.check').hide();
				$('.icon_invoice').find('.checked').show();
				$('.icon_invoice').find('.check').hide();
			}
			else{
				$(this).find('.checked').hide();
				$(this).find('.check').show();
				$('.icon_invoice').find('.checked').hide();
				$('.icon_invoice').find('.check').show();
			}
	 });
	//如果有一个未选中，全选的按钮变灰
        var num = $('.icon_invoice check').length;
        if (num > 0) {
            $('icon_invoice1 checked').hide();
            $('icon_invoice1 check').show();
        }
	//右侧删除按钮
	$('.right_car').each(function(){
		$(this).on('tap',function(){
			$(this).closest('section').hide();
		});
	});	
	//删除选中按钮
	//删除选中按钮
$('.a_delete').on('tap',function(){
//遍历可能要删除的section
$('section.sec_car').each(function(){	

//判断当前section是否被选中，如果选中，则删除
if($(this).find('i.checked').css('display') != 'none'){
$(this).remove();
var count = $('.icon_invoice').length;

//删除后判断是否还有选中项，如果没有了，取消全选
if(count == 0){
if($('div.icon_invoice1').find('i.checked').css('display') != 'none'){
$('div.icon_invoice1').find('i.checked').hide();
$('div.icon_invoice1').find('i.check').show();
}
}
}
});
});

});
</script>
</html>
